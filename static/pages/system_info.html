<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ–¥ï¸ ç³»ç»Ÿä¿¡æ¯ - æ·±è§†è¾¹ç¼˜è§†è§‰å¹³å°</title>
    <link rel="stylesheet" href="/static/css/unified-style.css">
    <style>
        /* ç»Ÿä¸€UIé£æ ¼ - åŸºäºframe_extraction.html */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, rgba(240, 242, 245, 0.9) 0%, rgba(250, 251, 252, 0.95) 100%);
            color: rgba(44, 62, 80, 0.9);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 300;
            color: rgba(44, 62, 80, 0.9);
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            color: rgba(127, 140, 141, 0.8);
        }

        .card {
            background: rgba(255, 255, 255, 0.85);
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(236, 240, 241, 0.6);
        }

        .card-title {
            font-size: 1.3rem;
            font-weight: 500;
            color: rgba(44, 62, 80, 0.9);
            margin: 0;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .btn-primary {
            background: rgba(52, 152, 219, 0.9);
            color: white;
        }

        .btn-primary:hover {
            background: rgba(41, 128, 185, 0.95);
            transform: translateY(-1px);
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
        }

        .status-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
            margin: 16px 0;
        }

        .status-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
        }

        .status-label {
            font-weight: 500;
            color: rgba(127, 140, 141, 0.8);
        }

        .status-value {
            font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
            font-weight: 600;
            color: rgba(44, 62, 80, 0.9);
        }

        .status-value.success {
            color: rgba(39, 174, 96, 0.9);
        }

        .status-value.warning {
            color: rgba(243, 156, 18, 0.9);
        }

        .status-value.error {
            color: rgba(231, 76, 60, 0.9);
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .progress-bar {
            background: rgba(233, 236, 239, 0.6);
            height: 8px;
            border-radius: 2px;
            overflow: hidden;
            margin-top: 8px;
        }

        .progress-fill {
            height: 100%;
            transition: width 0.3s ease;
            border-radius: 2px;
        }

        .progress-fill.low {
            background: rgba(46, 204, 113, 0.8);
        }

        .progress-fill.medium {
            background: rgba(243, 156, 18, 0.8);
        }

        .progress-fill.high {
            background: rgba(231, 76, 60, 0.8);
        }

        .log-container {
            background: rgba(44, 62, 80, 0.95);
            border-radius: 8px;
            overflow: hidden;
            margin-top: 20px;
        }

        .log-header {
            padding: 16px 20px;
            background: rgba(52, 73, 94, 0.95);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .log-content {
            padding: 16px 20px;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
            font-size: 13px;
            line-height: 1.5;
            color: rgba(236, 240, 241, 0.9);
            background: rgba(44, 62, 80, 0.95);
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }

        @media (max-width: 768px) {
            .grid-2, .grid-3 {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- é¡¶éƒ¨å¯¼èˆª -->
        <div id="navigation-container"></div>

        <!-- é¡µé¢æ ‡é¢˜ -->
        <header class="page-header">
            <h1 class="page-title">System Information</h1>
            <p class="page-subtitle">DeepVision Edge Platform - Real-time system monitoring and hardware status</p>
        </header>

        <!-- ç³»ç»Ÿæ¦‚è§ˆ -->
        <div class="grid-3">
            <!-- CPUä¿¡æ¯ -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ”§ CPUä¿¡æ¯</h3>
                    <button class="btn btn-primary btn-small" onclick="refreshCpuInfo()">åˆ·æ–°</button>
                </div>

                <div class="status-panel">
                    <div class="status-item">
                        <span class="status-label">CPUå‹å·:</span>
                        <span class="status-value" id="cpuModel">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">æ ¸å¿ƒæ•°:</span>
                        <span class="status-value" id="cpuCores">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">ä½¿ç”¨ç‡:</span>
                        <span class="status-value" id="cpuUsage">-</span>
                    </div>
                </div>

                <div class="progress-bar">
                    <div class="progress-fill low" id="cpuProgressBar" style="width: 0%;"></div>
                </div>
            </div>

            <!-- å†…å­˜ä¿¡æ¯ -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ’¾ å†…å­˜ä¿¡æ¯</h3>
                    <button class="btn btn-primary btn-small" onclick="refreshMemoryInfo()">åˆ·æ–°</button>
                </div>

                <div class="status-panel">
                    <div class="status-item">
                        <span class="status-label">æ€»å†…å­˜:</span>
                        <span class="status-value" id="totalMemory">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">å·²ä½¿ç”¨:</span>
                        <span class="status-value" id="usedMemory">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">ä½¿ç”¨ç‡:</span>
                        <span class="status-value" id="memoryUsage">-</span>
                    </div>
                </div>

                <div class="progress-bar">
                    <div class="progress-fill low" id="memoryProgressBar" style="width: 0%;"></div>
                </div>
            </div>

            <!-- å­˜å‚¨ä¿¡æ¯ -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ’¿ å­˜å‚¨ä¿¡æ¯</h3>
                    <button class="btn btn-primary btn-small" onclick="refreshStorageInfo()">åˆ·æ–°</button>
                </div>

                <div class="status-panel">
                    <div class="status-item">
                        <span class="status-label">æ€»å®¹é‡:</span>
                        <span class="status-value" id="totalStorage">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">å·²ä½¿ç”¨:</span>
                        <span class="status-value" id="usedStorage">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">ä½¿ç”¨ç‡:</span>
                        <span class="status-value" id="storageUsage">-</span>
                    </div>
                </div>

                <div class="progress-bar">
                    <div class="progress-fill low" id="storageProgressBar" style="width: 0%;"></div>
                </div>
            </div>
        </div>

        <!-- ç³»ç»Ÿè¯¦æƒ… -->
        <div class="grid-2">
            <!-- ç³»ç»Ÿä¿¡æ¯ -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ“‹ ç³»ç»Ÿè¯¦æƒ…</h3>
                </div>

                <div class="status-panel">
                    <div class="status-item">
                        <span class="status-label">æ“ä½œç³»ç»Ÿ:</span>
                        <span class="status-value" id="osName">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">å†…æ ¸ç‰ˆæœ¬:</span>
                        <span class="status-value" id="kernelVersion">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">æ¶æ„:</span>
                        <span class="status-value" id="architecture">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">è¿è¡Œæ—¶é—´:</span>
                        <span class="status-value" id="uptime">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">è´Ÿè½½å¹³å‡:</span>
                        <span class="status-value" id="loadAverage">-</span>
                    </div>
                </div>
            </div>

            <!-- ç½‘ç»œä¿¡æ¯ -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸŒ ç½‘ç»œä¿¡æ¯</h3>
                </div>

                <div class="status-panel">
                    <div class="status-item">
                        <span class="status-label">ä¸»æœºå:</span>
                        <span class="status-value" id="hostname">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">IPåœ°å€:</span>
                        <span class="status-value" id="ipAddress">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">ç½‘ç»œæ¥å£:</span>
                        <span class="status-value" id="networkInterface">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">ä¸Šä¼ æµé‡:</span>
                        <span class="status-value" id="uploadTraffic">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">ä¸‹è½½æµé‡:</span>
                        <span class="status-value" id="downloadTraffic">-</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ‘„åƒå¤´è®¾å¤‡ä¿¡æ¯ -->
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">ğŸ“¹ æ‘„åƒå¤´è®¾å¤‡</h3>
                <button class="btn btn-primary btn-small" onclick="refreshCameraInfo()">åˆ·æ–°è®¾å¤‡</button>
            </div>

            <div id="cameraDevices">
                <div style="text-align: center; color: rgba(127, 140, 141, 0.7); padding: 20px;">
                    æ­£åœ¨åŠ è½½æ‘„åƒå¤´è®¾å¤‡ä¿¡æ¯...
                </div>
            </div>
        </div>

        <!-- æ—¥å¿—åŒºåŸŸ -->
        <div class="log-container">
            <div class="log-header">
                <h3 style="color: rgba(255, 255, 255, 0.9); margin: 0;">ğŸ“‹ ç³»ç»Ÿæ—¥å¿—</h3>
                <button class="btn btn-warning btn-small" onclick="clearLog()">æ¸…ç©ºæ—¥å¿—</button>
            </div>
            <div class="log-content" id="logContent"></div>
        </div>
    </div>

    <script src="/static/js/navigation.js"></script>
    <script>
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            log('ğŸ–¥ï¸ ç³»ç»Ÿä¿¡æ¯é¡µé¢å·²åŠ è½½');
            loadSystemInfo();
            startAutoRefresh();
        });

        // æ—¥å¿—å‡½æ•°
        function log(message, type = 'info') {
            const logContent = document.getElementById('logContent');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}\n`;
            logContent.textContent += logEntry;
            logContent.scrollTop = logContent.scrollHeight;
        }

        // æ¸…ç©ºæ—¥å¿—
        function clearLog() {
            document.getElementById('logContent').textContent = '';
        }

        // åŠ è½½ç³»ç»Ÿä¿¡æ¯
        function loadSystemInfo() {
            log('ğŸ“Š æ­£åœ¨åŠ è½½ç³»ç»Ÿä¿¡æ¯...');
            refreshCpuInfo();
            refreshMemoryInfo();
            refreshStorageInfo();
            refreshSystemDetails();
            refreshNetworkInfo();
            refreshCameraInfo();
        }

        // åˆ·æ–°ç³»ç»Ÿä¿¡æ¯ - è°ƒç”¨åç«¯APIè·å–å®æ—¶æ•°æ®
        function refreshSystemInfo() {
            log('ğŸ“Š æ­£åœ¨è·å–ç³»ç»Ÿä¿¡æ¯...');

            fetch('/api/system/info')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        updateSystemDisplay(data.system);
                        log('âœ… ç³»ç»Ÿä¿¡æ¯æ›´æ–°æˆåŠŸ');
                    } else {
                        log('âŒ è·å–ç³»ç»Ÿä¿¡æ¯å¤±è´¥: ' + data.error);
                    }
                })
                .catch(error => {
                    log('âŒ ç½‘ç»œé”™è¯¯: ' + error.message);
                });
        }

        // æ›´æ–°ç³»ç»Ÿä¿¡æ¯æ˜¾ç¤º
        function updateSystemDisplay(system) {
            // æ›´æ–°CPUä¿¡æ¯
            document.getElementById('cpuModel').textContent = system.cpu.model || 'Unknown';
            document.getElementById('cpuCores').textContent = system.cpu.core_count || '0';
            document.getElementById('cpuUsage').textContent = system.cpu.usage_percent.toFixed(1) + '%';
            updateProgressBar('cpuProgressBar', system.cpu.usage_percent);

            // æ›´æ–°å†…å­˜ä¿¡æ¯
            const totalMemoryGB = (system.memory.total / (1024 * 1024 * 1024)).toFixed(1);
            const usedMemoryGB = (system.memory.used / (1024 * 1024 * 1024)).toFixed(1);
            document.getElementById('totalMemory').textContent = totalMemoryGB + ' GB';
            document.getElementById('usedMemory').textContent = usedMemoryGB + ' GB';
            document.getElementById('memoryUsage').textContent = system.memory.usage_percent.toFixed(1) + '%';
            updateProgressBar('memoryProgressBar', system.memory.usage_percent);

            // æ›´æ–°å­˜å‚¨ä¿¡æ¯ï¼ˆæ˜¾ç¤ºç¬¬ä¸€ä¸ªå­˜å‚¨è®¾å¤‡ï¼‰
            if (system.storage && system.storage.length > 0) {
                const storage = system.storage[0];
                const totalStorageGB = (storage.total / (1024 * 1024 * 1024)).toFixed(1);
                const usedStorageGB = (storage.used / (1024 * 1024 * 1024)).toFixed(1);
                document.getElementById('totalStorage').textContent = totalStorageGB + ' GB';
                document.getElementById('usedStorage').textContent = usedStorageGB + ' GB';
                document.getElementById('storageUsage').textContent = storage.usage_percent.toFixed(1) + '%';
                updateProgressBar('storageProgressBar', storage.usage_percent);
            }

            // æ›´æ–°ç³»ç»Ÿè¯¦æƒ…
            document.getElementById('osName').textContent = system.os_name || 'Unknown';
            document.getElementById('kernelVersion').textContent = system.kernel_version || 'Unknown';
            document.getElementById('architecture').textContent = system.architecture || 'Unknown';
            document.getElementById('uptime').textContent = formatUptime(system.uptime);
            document.getElementById('loadAverage').textContent = system.load_average.map(l => l.toFixed(2)).join(', ');

            // æ›´æ–°ç½‘ç»œä¿¡æ¯ï¼ˆæ˜¾ç¤ºç¬¬ä¸€ä¸ªç½‘ç»œæ¥å£ï¼‰
            if (system.network && system.network.length > 0) {
                const network = system.network[0];
                document.getElementById('hostname').textContent = system.hostname || 'Unknown';
                document.getElementById('ipAddress').textContent = network.ip_address || 'Unknown';
                document.getElementById('networkInterface').textContent = network.interface || 'Unknown';
                document.getElementById('uploadTraffic').textContent = formatBytes(network.bytes_sent);
                document.getElementById('downloadTraffic').textContent = formatBytes(network.bytes_received);
            }
        }

        // æ ¼å¼åŒ–è¿è¡Œæ—¶é—´
        function formatUptime(seconds) {
            const days = Math.floor(seconds / 86400);
            const hours = Math.floor((seconds % 86400) / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            return `${days}å¤© ${hours}å°æ—¶ ${minutes}åˆ†é’Ÿ`;
        }

        // æ ¼å¼åŒ–å­—èŠ‚æ•°
        function formatBytes(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB', 'GB', 'TB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // åˆ·æ–°æ‘„åƒå¤´ä¿¡æ¯
        function refreshCameraInfo() {
            log('ğŸ“¹ æ­£åœ¨è·å–æ‘„åƒå¤´è®¾å¤‡ä¿¡æ¯...');

            fetch('/api/system/cameras')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        updateCameraDisplay(data.cameras);
                        log('âœ… æ‘„åƒå¤´ä¿¡æ¯æ›´æ–°æˆåŠŸ');
                    } else {
                        log('âŒ è·å–æ‘„åƒå¤´ä¿¡æ¯å¤±è´¥: ' + data.error);
                    }
                })
                .catch(error => {
                    log('âŒ ç½‘ç»œé”™è¯¯: ' + error.message);
                });
        }

        // æ›´æ–°æ‘„åƒå¤´æ˜¾ç¤º
        function updateCameraDisplay(cameras) {
            const container = document.getElementById('cameraDevices');

            if (cameras.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: rgba(127, 140, 141, 0.7); padding: 20px;">æœªæ£€æµ‹åˆ°æ‘„åƒå¤´è®¾å¤‡</div>';
                return;
            }

            let html = '';
            cameras.forEach(camera => {
                html += `
                    <div class="status-item">
                        <span class="status-label">${camera.name}:</span>
                        <span class="status-value success">${camera.status}</span>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // å…¼å®¹æ€§æ–¹æ³• - ä¿æŒåŸæœ‰æ¥å£
        function refreshCpuInfo() { refreshSystemInfo(); }
        function refreshMemoryInfo() { refreshSystemInfo(); }
        function refreshStorageInfo() { refreshSystemInfo(); }
        function refreshSystemDetails() { refreshSystemInfo(); }
        function refreshNetworkInfo() { refreshSystemInfo(); }

        // å¼€å§‹è‡ªåŠ¨åˆ·æ–°
        function startAutoRefresh() {
            setInterval(() => {
                refreshSystemInfo();
                refreshCameraInfo();
            }, 5000); // æ¯5ç§’åˆ·æ–°ä¸€æ¬¡
        }

        // æ›´æ–°è¿›åº¦æ¡
        function updateProgressBar(elementId, percentage) {
            const progressBar = document.getElementById(elementId);
            if (progressBar) {
                progressBar.style.width = percentage + '%';

                // æ ¹æ®ä½¿ç”¨ç‡è®¾ç½®é¢œè‰²
                progressBar.className = 'progress-fill';
                if (percentage < 50) {
                    progressBar.classList.add('low');
                } else if (percentage < 80) {
                    progressBar.classList.add('medium');
                } else {
                    progressBar.classList.add('high');
                }
            }
        }
    </script>
</body>
</html>
